<div class="main_section">
    <div class="header fixed-header">
        <div class="search-box">
            <input type="text" placeholder="Search"
             [(ngModel)]="searchTerm"
                (input)="applySearch()"
             class="search-input">
        </div>
    </div>
    <div class="list_filter scrollable-content">
        <mat-accordion>

            <ng-container *ngIf="screen === 'WORK_ITEM'" >
                <mat-accordion multi="true">
                 <mat-expansion-panel [expanded]="panelExpanded" >
                <mat-expansion-panel-header>
                    
                <mat-panel-title>Priority {{ selectedPriorities.length > 0 ? '(' + selectedPriorities.length + ')' : '' }}</mat-panel-title>

                </mat-expansion-panel-header>
                <div class="priority-options">
                    <ng-container *ngIf="filteredPriorities && filteredPriorities.length > 0; else noMatch"> 
                        <mat-checkbox *ngFor="let item of filteredPriorities" 
                                [checked]="item.checked"
                                (change)="onPriorityChange($event, item)">
                        <div class="priority-item">
                            <mat-icon [class]="item.class">{{item.icon}}</mat-icon>
                            <span>{{item.name}}</span>
                        </div>
                    </mat-checkbox>
                    </ng-container>
                      <ng-template #noMatch>
                        <div style="font-size: 12px; color: grey; margin-left: 10px;  font-style: italic;" class="no-matches-text">No matches found</div>
                        </ng-template>
                </div>
            </mat-expansion-panel>

            <mat-expansion-panel [expanded]="panelExpanded" >
                <mat-expansion-panel-header>
                   <mat-panel-title>State {{ selectedStates.length > 0 ? '(' + selectedStates.length + ')' : '' }}</mat-panel-title>

                
                </mat-expansion-panel-header>
                <div class="state-options">
                    <ng-container *ngIf="filteredStates && filteredStates.length > 0; else noMatch">
                        <mat-checkbox *ngFor="let item of getDisplayedStates()" 
                                      [checked]="item.checked"
                                (change)="onStateChange($event, item)">
                        <div class="state-item">
                            <mat-icon [class]="getStateClass(item.name)">{{getStateIcon(item.name)}}</mat-icon>
                            <span>{{item.name}}</span>
                        </div>
                    </mat-checkbox>
                    
                    <!-- Show More/Less Button -->
                    <div class="show-more-toggle" *ngIf="filteredStates.length > 5">
                        <button mat-button 
                                (click)="toggleShowMoreStates()"
                                class="show-more-btn">
                            <span *ngIf="!showMoreStates">Show more</span>
                            <span *ngIf="showMoreStates">Show less</span>
                        </button>
                    </div>
                    </ng-container>
                     <ng-template #noMatch>
                        <div style="font-size: 12px; color: grey; margin-left: 10px;  font-style: italic;" class="no-matches-text">No matches found</div>
                        </ng-template>
                </div>

            </mat-expansion-panel>

            <mat-expansion-panel [expanded]="panelExpanded" >
                <mat-expansion-panel-header>
                   <mat-panel-title>Assignee {{ selectedAssignees.length > 0 ? '(' + selectedAssignees.length + ')' : '' }}</mat-panel-title>

                  
                </mat-expansion-panel-header>
                <div class="assignee-options">
                   <ng-container *ngIf="filteredAssignees && filteredAssignees.length > 0; else noMatch">
                     <mat-checkbox *ngFor="let item of getDisplayedAssignees()" 
                                    [checked]="item.checked"
                                (change)="onAssigneeChange($event, item)">
                        <div class="assignee-item">
                            <div class="avatar" [attr.data-initial]="item.name[0].toUpperCase()">
                                <img *ngIf="item.avatar" [src]="item.avatar" [alt]="item.name[0].toUpperCase()">
                            </div>
                            <span>{{item.name}}</span>
                        </div>
                    </mat-checkbox>
                    
                    <!-- Show More/Less Button -->
                    <div class="show-more-toggle" *ngIf="filteredAssignees.length > 5">
                        <button mat-button 
                                (click)="toggleShowMoreAssignees()"
                                class="show-more-btn">
                            <span *ngIf="!showMoreAssignees">Show more</span>
                            <span *ngIf="showMoreAssignees">Show less</span>
                        </button>
                    </div>
                   </ng-container>
                    <ng-template #noMatch>
                        <div style="font-size: 12px; color: grey; margin-left: 10px;  font-style: italic;" class="no-matches-text">No matches found</div>
                        </ng-template>
                </div>
            </mat-expansion-panel>

            <mat-expansion-panel [expanded]="panelExpanded" *ngIf="feature?.cycles">
                <mat-expansion-panel-header>
                   
                <mat-panel-title>Cycle {{ selectedCycles.length > 0 ? '(' + selectedCycles.length + ')' : '' }}</mat-panel-title>

                </mat-expansion-panel-header>
                <div class="cycle-options d-flex flex-column">
                    <ng-container *ngIf="filteredCycles && filteredCycles.length > 0; else noMatch">
                    <mat-checkbox *ngFor="let item of getDisplayedCycles()" 
                             [checked]="item.checked"
                        (change)="onCycleChange($event, item)">
                        <div class="cycle-item">
                            <span class="status-dot" 
                                [class.completed]="item.status === 'COMPLETED'"
                                [class.active]="item.status === 'ACTIVE'"
                                [class.upcoming]="item.status === 'UPCOMING'"></span>
                            <span>{{ item.title }}</span>
                        </div>
                    </mat-checkbox>
                    
                    <!-- Show More/Less Button -->
                    <div class="show-more-toggle" *ngIf="filteredCycles.length > 5">
                        <button mat-button 
                                (click)="toggleShowMoreCycles()"
                                class="show-more-btn">
                            <span *ngIf="!showMoreCycles">Show more</span>
                            <span *ngIf="showMoreCycles">Show less</span>
                        </button>
                    </div>
                    </ng-container>
                    <ng-template #noMatch>
                        <div style="font-size: 12px; color: grey; margin-left: 10px;  font-style: italic;" class="no-matches-text">No matches found</div>
                        </ng-template>
                </div>
            </mat-expansion-panel>

            <mat-expansion-panel [expanded]="panelExpanded" *ngIf="feature?.modules">
                <mat-expansion-panel-header>
                    <mat-panel-title>Module {{ selectedModules.length > 0 ? '(' + selectedModules.length + ')' : '' }}</mat-panel-title>

                
                </mat-expansion-panel-header>
                <div class="module-options">
                   <ng-container *ngIf="filteredModules && filteredModules.length > 0; else noMatch"> 
                     <mat-checkbox *ngFor="let item of getDisplayedModules()" 
                                     [checked]="item.checked"
                                (change)="onModuleChange($event, item)">
                        <div class="module-item">
                            <!-- <mat-icon></mat-icon> -->
                            <svg viewBox="0 0 24 24" class="h-3 w-3 flex-shrink-0 stroke-2" stroke="currentColor" fill="none" xmlns="http://www.w3.org/2000/svg" width="16" height="16"><path d="M19 3H5C3.89543 3 3 3.89543 3 5V19C3 20.1046 3.89543 21 5 21H19C20.1046 21 21 20.1046 21 19V5C21 3.89543 20.1046 3 19 3Z" stroke-linecap="round" stroke-linejoin="round"></path><path d="M8.77778 7H7.22222C7.09949 7 7 7.09949 7 7.22222V8.77778C7 8.90051 7.09949 9 7.22222 9H8.77778C8.90051 9 9 8.90051 9 8.77778V7.22222C9 7.09949 8.90051 7 8.77778 7Z" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M8.77778 15H7.22222C7.09949 15 7 15.0995 7 15.2222V16.7778C7 16.9005 7.09949 17 7.22222 17H8.77778C8.90051 17 9 16.9005 9 16.7778V15.2222C9 15.0995 8.90051 15 8.77778 15Z" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M16.7778 7H15.2222C15.0995 7 15 7.09949 15 7.22222V8.77778C15 8.90051 15.0995 9 15.2222 9H16.7778C16.9005 9 17 8.90051 17 8.77778V7.22222C17 7.09949 16.9005 7 16.7778 7Z" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M16.7778 15H15.2222C15.0995 15 15 15.0995 15 15.2222V16.7778C15 16.9005 15.0995 17 15.2222 17H16.7778C16.9005 17 17 16.9005 17 16.7778V15.2222C17 15.0995 16.9005 15 16.7778 15Z" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg>
                            <span>{{item.title}}</span>
                        </div>
                    </mat-checkbox>
                    
                    <!-- Show More/Less Button -->
                    <div class="show-more-toggle" *ngIf="filteredModules.length > 5">
                        <button mat-button 
                                (click)="toggleShowMoreModules()"
                                class="show-more-btn">
                            <span *ngIf="!showMoreModules">Show more</span>
                            <span *ngIf="showMoreModules">Show less</span>
                        </button>
                    </div>
                   </ng-container>
                     <ng-template #noMatch>
                        <div style="font-size: 12px; color: grey; margin-left: 10px;  font-style: italic;" class="no-matches-text">No matches found</div>
                        </ng-template>
                </div>
            </mat-expansion-panel>

            <!-- <mat-expansion-panel [expanded]="true" >
                <mat-expansion-panel-header>
                    <mat-panel-title>Mention ({{selectedmentions.length}})</mat-panel-title>
                </mat-expansion-panel-header>
                <div class="assignee-options">
                    <mat-checkbox *ngFor="let item of membersList" 
                                [checked]="isMentionselected(item)"
                                (change)="onMentionChange($event, item)">
                       
                           <div class="assignee-item">
                            <div class="avatar" [attr.data-initial]="item.name[0].toUpperCase()">
                                <img *ngIf="item.avatar" [src]="item.avatar" [alt]="item.name[0].toUpperCase()">
                            </div>
                            <span>{{item.name}}</span>
                        </div>
                    </mat-checkbox>
                </div>
            </mat-expansion-panel> -->

            <mat-expansion-panel [expanded]="panelExpanded" >
                <mat-expansion-panel-header>
                   <mat-panel-title>Created by {{ selectedCreatedBy.length > 0 ? '(' + selectedCreatedBy.length + ')' : '' }}</mat-panel-title>
        
                 
                </mat-expansion-panel-header>
                <div class="assignee-options">
                   <ng-container *ngIf="filteredCreatedBy && filteredCreatedBy.length > 0; else noMatch">
                     <mat-checkbox *ngFor="let item of getDisplayedCreatedBy()" 
                                     [checked]="item.checked"
                                (change)="onCreatedByChange($event, item)">
                          <div class="assignee-item">
                            <div class="avatar" [attr.data-initial]="item.name[0].toUpperCase()">
                                <img *ngIf="item.avatar" [src]="item.avatar" [alt]="item.name[0].toUpperCase()">
                            </div>
                            <span>{{item.name}}</span>
                        </div>
                    </mat-checkbox>
                    
                    <!-- Show More/Less Button -->
                    <div class="show-more-toggle" *ngIf="filteredCreatedBy.length > 5">
                        <button mat-button 
                                (click)="toggleShowMoreCreatedBy()"
                                class="show-more-btn">
                            <span *ngIf="!showMoreCreatedBy">Show more</span>
                            <span *ngIf="showMoreCreatedBy">Show less</span>
                        </button>
                    </div>
                   </ng-container>
                    <ng-template #noMatch>
                        <div style="font-size: 12px; color: grey; margin-left: 10px;  font-style: italic;" class="no-matches-text">No matches found</div>
                        </ng-template>
                </div>
            </mat-expansion-panel>

            <mat-expansion-panel [expanded]="panelExpanded" >
                <mat-expansion-panel-header>
                   <mat-panel-title>Label {{ selectedLabels.length > 0 ? '(' + selectedLabels.length + ')' : '' }}</mat-panel-title>

           
                </mat-expansion-panel-header>
                <div class="label-options">
                   <ng-container *ngIf="filteredLabels && filteredLabels.length > 0; else noMatch">
                     <mat-checkbox *ngFor="let item of getDisplayedLabels()" 
                                    [checked]="item.checked"
                                (change)="onLabelChange($event, item)">
                        <div class="label-item">
                            <div class="color-dot" [style.background-color]="item.color"></div>
                            <span>{{item.label}}</span>
                        </div>
                    </mat-checkbox>
                    
                    <!-- Show More/Less Button -->
                    <div class="show-more-toggle" *ngIf="filteredLabels.length > 5">
                        <button mat-button 
                                (click)="toggleShowMoreLabels()"
                                class="show-more-btn">
                            <span *ngIf="!showMoreLabels">Show more</span>
                            <span *ngIf="showMoreLabels">Show less</span>
                        </button>
                    </div>
                   </ng-container>
                    <ng-template #noMatch>
                        <div style="font-size: 12px; color: grey; margin-left: 10px;  font-style: italic;" class="no-matches-text">No matches found</div>
                        </ng-template>
                </div>
            </mat-expansion-panel>

            <!-- <mat-expansion-panel [expanded]="true">
                <mat-expansion-panel-header>
                    <mat-panel-title>Work item Grouping</mat-panel-title>
                </mat-expansion-panel-header>
                <div class="work-item-grouping-options">
                    <mat-radio-group>
                        <mat-radio-button *ngFor="let option of workItemGroupingOptions"
                                        [checked]="option.checked"
                                        (change)="onGroupingChange(option)">
                            {{option.name}}
                        </mat-radio-button>
                    </mat-radio-group>
                </div>
            </mat-expansion-panel> -->

            
<mat-expansion-panel [expanded]="panelExpanded">
  <mat-expansion-panel-header>
    <mat-panel-title>Start date</mat-panel-title>
  </mat-expansion-panel-header>
  <div class="date-options">
    <mat-checkbox *ngFor="let option of startDateOptions"
                  [checked]="option.checked"
                  (change)="onStartDateOptionChange($event, option)">
      {{ option.name }}
    </mat-checkbox>

    <mat-form-field class="custom-date-picker" *ngIf="showCustomStartDatePicker">
      <input matInput 
             [matDatepicker]="startDatePicker"  
             (dateChange)="onCustomStartDateChange($event)" 
             [(ngModel)]="customSelectedStartDate">
      <mat-datepicker-toggle matSuffix [for]="startDatePicker"></mat-datepicker-toggle>
      <mat-datepicker #startDatePicker></mat-datepicker>
    </mat-form-field>
  </div>
</mat-expansion-panel>


<mat-expansion-panel [expanded]="panelExpanded">
  <mat-expansion-panel-header>
    <mat-panel-title>Due date</mat-panel-title>
  </mat-expansion-panel-header>
  <div class="date-options">
    <mat-checkbox *ngFor="let option of dueDateOptions"
                  [checked]="option.checked"
                  (change)="onDueDateOptionChange($event, option)">
      {{ option.name }}
    </mat-checkbox>

    <mat-form-field class="custom-date-picker" *ngIf="showCustomDueDatePicker">
      <input matInput 
             [matDatepicker]="dueDatePicker"  
             (dateChange)="onCustomDueDateChange($event)" 
             [(ngModel)]="customSelectedDueDate">
      <mat-datepicker-toggle matSuffix [for]="dueDatePicker"></mat-datepicker-toggle>
      <mat-datepicker #dueDatePicker></mat-datepicker>
    </mat-form-field>
  </div>
</mat-expansion-panel>
            </mat-accordion>
            </ng-container>

            <ng-container *ngIf="screen === 'PROJECT'">

               <!-- <div class="assignee-options">
                    <mat-checkbox [checked]="isMyprojects" (change)="isMyprojectsView($event)">
                        <div class="assignee-item">
                            <span>My projects</span>
                        </div>
                    </mat-checkbox>
                </div> -->

                  <mat-expansion-panel [expanded]="true" >
                <mat-expansion-panel-header>
                    <mat-panel-title>AccessType</mat-panel-title>
                </mat-expansion-panel-header>
                <div class="assignee-options">
                    <mat-checkbox *ngFor="let item of accessTypes" 
                                [checked]="isAccessSelected(item)"
                                (change)="onAccessChange($event, item)">
                        <div class="assignee-item">
                            <span>{{item.name}}</span>
                            
                        </div>
                    </mat-checkbox>
                </div>
            </mat-expansion-panel>

                 <mat-expansion-panel [expanded]="true" >
                <mat-expansion-panel-header>
            <mat-panel-title>
            Lead {{ selectedLeads.length > 0 ? '(' + selectedLeads.length + ')' : '' }}
            </mat-panel-title>
                </mat-expansion-panel-header>
                <div class="assignee-options">
                    <ng-container *ngIf="membersList && membersList.length > 0; else noMatch">
                    <mat-checkbox *ngFor="let item of membersList" 
                                [checked]="isLeadSelected(item)"
                                (change)="onLeadChange($event, item)">
                        <div class="assignee-item">
                            <div class="avatar" [attr.data-initial]="item.name[0]">
                                <img *ngIf="item.avatar" [src]="item.avatar" [alt]="item.name">
                            </div>
                            <span>{{item.name}}</span>
                        </div>
                    </mat-checkbox>
                    </ng-container>
                    <ng-template #noMatch>
                        <div style="font-size: 12px; color: grey; margin-left: 10px;  font-style: italic;" class="no-matches-text">No matches found</div>
                    </ng-template>
                </div>
            </mat-expansion-panel>

            <mat-expansion-panel [expanded]="true" >
                <mat-expansion-panel-header>
                    <mat-panel-title>Members {{ selectedmembers.length > 0 ? '(' + selectedmembers.length + ')' : '' }}</mat-panel-title>
                </mat-expansion-panel-header>
                <div class="assignee-options">
                    <ng-container *ngIf="membersList && membersList.length > 0; else noMatch">
                    <mat-checkbox *ngFor="let item of membersList" 
                                [checked]="ismemberSelected(item)"
                                (change)="onMembersChange($event, item)">
                        <div class="assignee-item">
                            <div class="avatar" [attr.data-initial]="item.name[0].toUpperCase()">
                                <img *ngIf="item.avatar" [src]="item.avatar" [alt]="item.name[0].toUpperCase()">
                            </div>
                            <span>{{item.name}}</span>
                        </div>
                    </mat-checkbox>
                    </ng-container>
                    <ng-template #noMatch>
                        <div style="font-size: 12px; color: grey; margin-left: 10px;  font-style: italic;" class="no-matches-text">No matches found</div>
                    </ng-template>
                </div>
            </mat-expansion-panel>

            <mat-expansion-panel [expanded]="true" >
                <mat-expansion-panel-header>
                    <mat-panel-title>Created date</mat-panel-title>
                </mat-expansion-panel-header>
                <div class="assignee-options">
                    <mat-radio-group [(ngModel)]="selectedDateOption" (change)="onDateOptionSelection($event)">
                        <mat-radio-button *ngFor="let item of datesList" [value]="item" class="priority-radio">
                            <div class="assignee-item">
                            <span>{{ item }}</span>
                            </div>
                        </mat-radio-button>
                        </mat-radio-group>
                </div>
            </mat-expansion-panel>
            </ng-container>
            <ng-container *ngIf="screen === 'PAGE_FILTER'">
                <mat-expansion-panel [expanded]="true" >
                <mat-expansion-panel-header>
                    <mat-panel-title>AccessType</mat-panel-title>
                </mat-expansion-panel-header>
                <div class="assignee-options">
                    <mat-checkbox *ngFor="let item of pageAccessTypes" 
                                [checked]="isAccessSelected(item)"
                                (change)="onAccessChange($event, item)">
                        <div class="assignee-item">
                            <span>{{item.name}}</span>
                            
                        </div>
                    </mat-checkbox>
                </div>
            </mat-expansion-panel>
            <mat-expansion-panel [expanded]="panelExpanded" *ngIf="feature?.modules">
                <mat-expansion-panel-header>
                    <mat-panel-title>Linked Module {{ selectedModules.length > 0 ? '(' + selectedModules.length + ')' : '' }}</mat-panel-title>

                
                </mat-expansion-panel-header>
                <div class="module-options">
                   <ng-container *ngIf="filteredModules && filteredModules.length > 0; else noMatch"> 
                     <mat-checkbox *ngFor="let item of getDisplayedModules()" 
                                     [checked]="item.checked"
                                (change)="onModuleChange($event, item)">
                        <div class="module-item">
                            <!-- <mat-icon></mat-icon> -->
                            <svg viewBox="0 0 24 24" class="h-3 w-3 flex-shrink-0 stroke-2" stroke="currentColor" fill="none" xmlns="http://www.w3.org/2000/svg" width="16" height="16"><path d="M19 3H5C3.89543 3 3 3.89543 3 5V19C3 20.1046 3.89543 21 5 21H19C20.1046 21 21 20.1046 21 19V5C21 3.89543 20.1046 3 19 3Z" stroke-linecap="round" stroke-linejoin="round"></path><path d="M8.77778 7H7.22222C7.09949 7 7 7.09949 7 7.22222V8.77778C7 8.90051 7.09949 9 7.22222 9H8.77778C8.90051 9 9 8.90051 9 8.77778V7.22222C9 7.09949 8.90051 7 8.77778 7Z" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M8.77778 15H7.22222C7.09949 15 7 15.0995 7 15.2222V16.7778C7 16.9005 7.09949 17 7.22222 17H8.77778C8.90051 17 9 16.9005 9 16.7778V15.2222C9 15.0995 8.90051 15 8.77778 15Z" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M16.7778 7H15.2222C15.0995 7 15 7.09949 15 7.22222V8.77778C15 8.90051 15.0995 9 15.2222 9H16.7778C16.9005 9 17 8.90051 17 8.77778V7.22222C17 7.09949 16.9005 7 16.7778 7Z" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M16.7778 15H15.2222C15.0995 15 15 15.0995 15 15.2222V16.7778C15 16.9005 15.0995 17 15.2222 17H16.7778C16.9005 17 17 16.9005 17 16.7778V15.2222C17 15.0995 16.9005 15 16.7778 15Z" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg>
                            <span>{{item.title}}</span>
                        </div>
                    </mat-checkbox>
                    
                    <!-- Show More/Less Button -->
                    <div class="show-more-toggle" *ngIf="filteredModules.length > 5">
                        <button mat-button 
                                (click)="toggleShowMoreModules()"
                                class="show-more-btn">
                            <span *ngIf="!showMoreModules">Show more</span>
                            <span *ngIf="showMoreModules">Show less</span>
                        </button>
                    </div>
                   </ng-container>
                     <ng-template #noMatch>
                        <div style="font-size: 12px; color: grey; margin-left: 10px;  font-style: italic;" class="no-matches-text">No matches found</div>
                        </ng-template>
                </div>
            </mat-expansion-panel>
            <mat-expansion-panel [expanded]="panelExpanded" *ngIf="feature?.cycles">
                <mat-expansion-panel-header>
                   
                <mat-panel-title> Linked Cycle {{ selectedCycles.length > 0 ? '(' + selectedCycles.length + ')' : '' }}</mat-panel-title>

                </mat-expansion-panel-header>
                <div class="cycle-options d-flex flex-column">
                    <ng-container *ngIf="filteredCycles && filteredCycles.length > 0; else noMatch">
                    <mat-checkbox *ngFor="let item of getDisplayedCycles()" 
                             [checked]="item.checked"
                        (change)="onCycleChange($event, item)">
                        <div class="cycle-item">
                            <span class="status-dot" 
                                [class.completed]="item.status === 'COMPLETED'"
                                [class.active]="item.status === 'ACTIVE'"
                                [class.upcoming]="item.status === 'UPCOMING'"></span>
                            <span>{{ item.title }}</span>
                        </div>
                    </mat-checkbox>
                    
                    <!-- Show More/Less Button -->
                    <div class="show-more-toggle" *ngIf="filteredCycles.length > 5">
                        <button mat-button 
                                (click)="toggleShowMoreCycles()"
                                class="show-more-btn">
                            <span *ngIf="!showMoreCycles">Show more</span>
                            <span *ngIf="showMoreCycles">Show less</span>
                        </button>
                    </div>
                    </ng-container>
                    <ng-template #noMatch>
                        <div style="font-size: 12px; color: grey; margin-left: 10px;  font-style: italic;" class="no-matches-text">No matches found</div>
                        </ng-template>
                </div>
            </mat-expansion-panel>
            <mat-expansion-panel [expanded]="panelExpanded" *ngIf="feature?.pages">
                <mat-expansion-panel-header>
                    <mat-panel-title>Linked Pages {{selectedPages.length > 0 ? '(' + selectedPages.length + ')' : '' }}</mat-panel-title>

                
                </mat-expansion-panel-header>
                <div class="module-options">
                   <ng-container *ngIf="filteredPages && filteredPages.length > 0; else noMatch"> 
                     <mat-checkbox *ngFor="let item of getDisplayedPages()" 
                                     [checked]="item.checked"
                                (change)="onPageChange($event, item)">
                        <div class="module-item">
                            <!-- <mat-icon></mat-icon> -->
                            <img src="https://d2z9497xp8xb12.cloudfront.net/prod-images/605581c1757661622477file-02-stroke-rounded.svg" alt="">
                            <!-- <svg viewBox="0 0 24 24" class="h-3 w-3 flex-shrink-0 stroke-2" stroke="currentColor" fill="none" xmlns="http://www.w3.org/2000/svg" width="16" height="16"><path d="M19 3H5C3.89543 3 3 3.89543 3 5V19C3 20.1046 3.89543 21 5 21H19C20.1046 21 21 20.1046 21 19V5C21 3.89543 20.1046 3 19 3Z" stroke-linecap="round" stroke-linejoin="round"></path><path d="M8.77778 7H7.22222C7.09949 7 7 7.09949 7 7.22222V8.77778C7 8.90051 7.09949 9 7.22222 9H8.77778C8.90051 9 9 8.90051 9 8.77778V7.22222C9 7.09949 8.90051 7 8.77778 7Z" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M8.77778 15H7.22222C7.09949 15 7 15.0995 7 15.2222V16.7778C7 16.9005 7.09949 17 7.22222 17H8.77778C8.90051 17 9 16.9005 9 16.7778V15.2222C9 15.0995 8.90051 15 8.77778 15Z" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M16.7778 7H15.2222C15.0995 7 15 7.09949 15 7.22222V8.77778C15 8.90051 15.0995 9 15.2222 9H16.7778C16.9005 9 17 8.90051 17 8.77778V7.22222C17 7.09949 16.9005 7 16.7778 7Z" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M16.7778 15H15.2222C15.0995 15 15 15.0995 15 15.2222V16.7778C15 16.9005 15.0995 17 15.2222 17H16.7778C16.9005 17 17 16.9005 17 16.7778V15.2222C17 15.0995 16.9005 15 16.7778 15Z" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg> -->
                            <span>{{item.title}}</span>
                        </div>
                    </mat-checkbox>
                    
                    <!-- Show More/Less Button -->
                    <div class="show-more-toggle" *ngIf="filteredPages.length > 5">
                        <button mat-button 
                                (click)="toggleShowMorePages()"
                                class="show-more-btn">
                            <span *ngIf="!showMorePages">Show more</span>
                            <span *ngIf="showMorePages">Show less</span>
                        </button>
                    </div>
                   </ng-container>
                     <ng-template #noMatch>
                        <div style="font-size: 12px; color: grey; margin-left: 10px;  font-style: italic;" class="no-matches-text">No matches found</div>
                        </ng-template>
                </div>
            </mat-expansion-panel>
            <mat-expansion-panel [expanded]="panelExpanded" >
                <mat-expansion-panel-header>
                   <mat-panel-title>Members {{ selectedAssignees.length > 0 ? '(' + selectedAssignees.length + ')' : '' }}</mat-panel-title>
                </mat-expansion-panel-header>
                <div class="assignee-options">
                   <ng-container *ngIf="filteredAssignees && filteredAssignees.length > 0; else noMatch">
                     <mat-checkbox *ngFor="let item of getDisplayedAssignees()" 
                                    [checked]="item.checked"
                                (change)="onAssigneeChange($event, item)">
                        <div class="assignee-item">
                            <div class="avatar" [attr.data-initial]="item.name[0].toUpperCase()">
                                <img *ngIf="item.avatar" [src]="item.avatar" [alt]="item.name[0].toUpperCase()">
                            </div>
                            <span>{{item.name}}</span>
                        </div>
                    </mat-checkbox>
                    
                    <!-- Show More/Less Button -->
                    <div class="show-more-toggle" *ngIf="filteredAssignees.length > 5">
                        <button mat-button 
                                (click)="toggleShowMoreAssignees()"
                                class="show-more-btn">
                            <span *ngIf="!showMoreAssignees">Show more</span>
                            <span *ngIf="showMoreAssignees">Show less</span>
                        </button>
                    </div>
                   </ng-container>
                    <ng-template #noMatch>
                        <div style="font-size: 12px; color: grey; margin-left: 10px;  font-style: italic;" class="no-matches-text">No matches found</div>
                        </ng-template>
                </div>
            </mat-expansion-panel>

            </ng-container>
        </mat-accordion>
    </div>
</div>