<div class="projects-summary">
  <div class="tab_title">Projects Summary</div>

  <!-- Top Summary Stats -->
  <div class="summary-cards">
    <div class="summary-card"> <strong>{{totalProjects}}</strong> <span>Total Projects</span> </div>
    <div class="summary-card active"> <strong>{{activeProjects}}</strong> <span>Active Projects</span> </div>
    <div class="summary-card overdue"> <strong>{{overDueProjects}}</strong> <span>Overdue Projects</span> </div>
    <div class="summary-card completed"> <strong>{{completedProjects}}</strong> <span>Completed Projects</span> </div>
  </div>

  <!-- Loading State -->
  <section class="loader_section" *ngIf="pageLoader">
    <div class="api_loader">
      <app-anime-loader></app-anime-loader>
    </div>
  </section>

  <!-- Projects List State -->
  <div class="inside-content">
    <!-- Search & Actions -->
    <div class="search-actions">
      <div class="left_sec">
        <input type="text" [(ngModel)]="searchText" (ngModelChange)="searchFilter(searchText)"
          placeholder="Search by name or id" />
        <button (click)=" getProjectsList()" class="action-btn"><img
            src="../../../../../../assets/images/work-management/refresh_icon.png" alt=""></button>
        <button (click)=" openFilterMenu()" class="action-btn"><img
            src="../../../../../../assets/images/work-management/filter_funnel.png" alt=""></button>
        <button (click)="onPriority($event)" class="action-btn"><img
            src="../../../../../../assets/images/work-management/filter_sort.png" alt=""></button>

      </div>
      <div class="right_sec" *ngIf="totalProjects > 0">
        <button (click)="createProject()" class="new-project-btn">New Project</button>
      </div>

    </div>

    <!-- Filter Display Section -->
    <div class="filter-group-container mb-1" *ngIf="filterGroups.length > 0">
      <div class="filter-group" *ngFor="let group of filterGroups">
        <div class="group-title">{{ group.key }}</div>
        <div class="chip-wrapper">
          <div class="chip" *ngFor="let item of group.value">
            <ng-container [ngSwitch]="group.key">

              <ng-container *ngSwitchCase="'Lead'">
                <span class="avatar">{{ getInitials(item.name) }}</span>
                <span class="chip-text">{{ item.name }}</span>
              </ng-container>

              <ng-container *ngSwitchCase="'Members'">
                <span class="avatar">{{ getInitials(item.name) }}</span>
                <span class="chip-text">{{ item.name }}</span>
              </ng-container>

              <ng-container *ngSwitchDefault>
                <span class="chip-text">{{ item.name }}</span>
              </ng-container>

            </ng-container>

            <span class="close-btn" (click)="removeFilter(group.key, item)">Ã—</span>
          </div>
        </div>
      </div>
      <div class="filter-group" *ngIf="filterGroups.length > 0">
        <div class="chip-wrapper">
          <div class="chip clear-chip" (click)="clearAllFilters()">
            Clear All
            <span class="close-btn">Ã—</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Project List -->
    <div class="listProject_section" *ngIf="!pageLoader && totalProjects > 0">
      <ng-container *ngFor="let project of searchList">
        <div (click)="goToWorkItem(project)" class="project-card">
          <div class="left">
            <div class="emoji">{{project?.icon || 'ðŸ˜Š'}}</div>
            <div class="details">
              <div class="title">{{ project?.name }} â€“ <span>{{ project?.projectDisplayId }}</span></div>
              <div class="meta">
                <div class="owner">
                  <img src="../../../../../../assets/images/work-management/single_person.png" alt="">
                  <div class="title">{{ project?.lead!=null ? project?.lead?.name : 'N/A' }} &nbsp; &nbsp;</div>
                </div>

              <div class="member">
                <img src="../../../../../../assets/images/work-management/multi_person.png" alt="">
                <div class="title">
                  {{ project?.members?.length > 0 ? project?.members?.length : 0 }} Team Members &nbsp; &nbsp;
                </div>
              </div>

                <!-- <div class="due">
                 <img src="../../../../../../assets/images/work-management/due_icon.png" alt="">
                 <div class="title">
                       
          Due {{ project.dueDate }} &nbsp;  &nbsp;
                 </div>
            </div>
      <div class="status">
        <img src="../../../../../../assets/images/work-management/inprogress_icon.png" alt="">
         <span class="p_status">{{ project.status }}</span>
      </div> -->

              </div>
            </div>
          </div>
       <div class="right">
  <!-- Settings -->
  <div class="icon-btn" style="width: auto;" *ngIf="isProjectMember(project)"
    (click)="goToSettings(project); $event.stopPropagation(); projectdata(project)"
    matTooltip="Project Settings">
    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
      class="lucide lucide-settings h-3.5 w-3.5 stroke-[1.5]">
      <path
        d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z">
      </path>
      <circle cx="12" cy="12" r="3"></circle>
    </svg>
  </div>

  <!-- Favourite Icon -->
  <div class="icon-btn" style="width: auto;" [matTooltip]="isFavourite(project.id) ? 'Unmark Favourite' : 'Mark as Favourite'"
     (click)="changeFav(project); $event.stopPropagation()">
  <mat-icon [ngClass]="{ 'favourite': isFavourite(project.id) }" color="warn">
    {{ isFavourite(project.id) ? 'star' : 'star_border' }}
  </mat-icon>
</div>

  <!-- Archive Icon -->
  <div class="icon-btn" style="width: auto;"  matTooltip="Archive Project"
    (click)="updateProjectStatus(project, 'archived'); $event.stopPropagation()">
    <mat-icon [ngClass]="{ 'archived': project.archived }" color="primary">
      {{ project.archived ? 'unarchive' : 'archive' }}
    </mat-icon>
  </div>

  <!-- Copy Link -->
  <div class="icon-btn" style="width: auto;" matTooltip="Copy Project Link"
    (click)="copyURLToClipboard(); $event.stopPropagation()">
    <img src="../../../../../../assets/images/work-management/link.png" alt="">
  </div>

  <!-- Delete -->
  <div style="width: auto;" class="icon-btn" *ngIf="isProjectMember(project)" matTooltip="Delete Project"
    (click)="openDeleteModal(project); $event.stopPropagation();">
    <mat-icon>delete_outline</mat-icon>
  </div>

  <!-- Join Project -->
  <div *ngIf="!isProjectMember(project)" class="join-btn" matTooltip="Join Project"
    (click)="joinProject(project); $event.stopPropagation()">
    Join Project
  </div>
</div>



          <!-- Bootstrap Modal -->
          <div class="modal fade" id="deleteConfirmModal" tabindex="-1" aria-labelledby="deleteConfirmModalLabel"
            aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
              <div class="modal-content p-3">
                <div>
                  <div class="mb-3">
                    <div class="bg-danger bg-opacity-10 rounded-circle d-inline-flex p-3">
                      <img src="../../../../../../../../../assets/images/blogs/delete_feature_icon.svg"
                        alt="delete_icon" />
                    </div>
                  </div>
                  <h5 class="fw-bold mb-2">Delete {{ deleteTarget?.name || 'Item' }}</h5>
                  <p class="text-secondary mb-4">Are you sure you want to delete this item? This action cannot be
                    undone.</p>

                  <div class="d-flex justify-content-center gap-3">
                    <button type="button" class="btn btn-outline-dark" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-danger"
                      (click)="confirmDelete() ; $event.stopPropagation()">Delete</button>
                  </div>
                </div>
              </div>
            </div>
          </div>

        </div>
      </ng-container>
    </div>
  </div>

  <!-- Empty State -->
  <div *ngIf="!pageLoader && totalProjects === 0"
       class="empty-screen h-100 d-flex flex-column align-items-center justify-content-center gap-2">
    <div class="empty-content h-100 d-flex flex-column align-items-center justify-content-center gap-1">
      <div class="empty-text d-flex justify-content-center flex-column align-items-center">
        <h4>No projects have been created yet.</h4>
        <p>Please create a new project to manage and track your tasks.</p>
      </div>
      <div class="empty-img d-flex justify-content-center">
        <img class="w-100"
          src="https://d2z9497xp8xb12.cloudfront.net/prod-images/200953c1752562337738ChatGPT Image Jul 15, 2025, 12_22_02 PM.png"
          alt="empty-img">
      </div>
      <div class="empty-btn d-flex justify-content-center">
        <button (click)="createProject()" class="new-project-btn">Create Project</button>
      </div>
    </div>
  </div>

  <!-- *ngIf="!isProjectMember(project)" -->
</div>

      <!-- <ng-container *ngIf="skeletonLoader">
        <div class="project-card skeleton-card" *ngFor="let item of [1,2,3,4,5]">
          <div class="horizontal_bar"></div>
        </div>
      </ng-container> -->
